{"version":3,"file":"index.js","sources":["../src/js/kalkulacka.js","../src/js/formular.js"],"sourcesContent":["import '../css/basic.css';\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const typSelect = document.getElementById(\"typ\");\n  const dumFields = document.getElementById(\"dum-fields\");\n  const bytFields = document.getElementById(\"byt-fields\");\n\n  if (!typSelect || !dumFields || !bytFields) return;\n\n  typSelect.addEventListener(\"change\", () => {\n    if (typSelect.value === \"dum\") {\n      dumFields.style.display = \"block\";\n      bytFields.style.display = \"none\";\n    } else {\n      dumFields.style.display = \"none\";\n      bytFields.style.display = \"block\";\n    }\n  });\n\n  document.getElementById(\"spocitatBtn\")?.addEventListener(\"click\", spocitejCenu);\n\n  const aktualniRokEl = document.getElementById(\"aktualniRok\");\n  if (aktualniRokEl) {\n    aktualniRokEl.textContent = new Date().getFullYear();\n  }\n});\n\nwindow.spocitejCenu = function() {\n  const vysledek = document.getElementById(\"vysledek\");\n  vysledek.innerHTML = `<p><span class=\"loader\"></span></p>`;  \n\n  const delay = Math.random() * 1000 + 500;\n\n  setTimeout(() => {\n    const lokalita = document.getElementById(\"lokalita\").value;\n    const typ = document.getElementById(\"typ\").value;\n\n    const cenyLokalit = {\n      praha1: 492, praha2: 470, praha3: 460, praha4: 418,\n      praha5: 433, praha6: 417, praha7: 441, praha8: 417,\n      praha9: 421, praha10: 405\n    };\n\n    const cenaZaM2 = cenyLokalit[lokalita] || 350;\n\n    if (typ === \"dum\") {\n      const jednotky = parseInt(document.getElementById(\"jednotky\").value);\n      const plocha = parseFloat(document.getElementById(\"plocha-dum\").value);\n      if (!jednotky || !plocha) {\n        vysledek.innerText = \"Zadejte platné údaje pro dům.\";\n        return;\n      }\n      const celkovyNajem = plocha * cenaZaM2;\n      const sprava = (celkovyNajem + jednotky * 450) * 0.07;\n      vysledek.innerHTML = `\n        <p><strong>Přibližná cena správy:</strong> ${sprava.toLocaleString()} Kč / měsíc</p>\n        <p><strong>Přibližná cena nájmu:</strong> ${celkovyNajem.toLocaleString()} Kč / měsíc</p>\n      `;\n    } else {\n      const plocha = parseFloat(document.getElementById(\"plocha-byt\").value);\n      const dispozice = document.getElementById(\"dispozice\").value;\n      const koeficienty = { \"1kk\": 1, \"1+1\": 1.05, \"2kk\": 1.1, \"2+1\": 1.15, \"3kk\": 1.2, \"3+1\": 1.25, \"4+\": 1.3 };\n      const koef = koeficienty[dispozice] || 1;\n      const najem = plocha * cenaZaM2 * koef;\n      const sprava = najem * 0.1;\n      vysledek.innerHTML = `\n        <p><strong>Správa:</strong> ${sprava.toLocaleString()} Kč / měsíc</p>\n        <p><strong>Příjem:</strong> ${najem.toLocaleString()} Kč / měsíc</p>\n      `;\n    }\n  }, delay);\n}\n","// src/js/formular.js\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const form = document.getElementById(\"kontaktniFormular\");\n  if (!form) {\n    console.warn(\"Formulář #kontaktniFormular nebyl nalezen na této stránce.\");\n    return;\n  }\n\n  // pomocná funkce: počká až bude grecaptcha dostupné (max 5s)\n  function waitForGrecaptcha(timeout = 5000) {\n    return new Promise((resolve) => {\n      const start = Date.now();\n      (function check() {\n        if (window.grecaptcha && typeof window.grecaptcha.getResponse === \"function\") {\n          resolve(true);\n        } else if (Date.now() - start > timeout) {\n          resolve(false);\n        } else {\n          setTimeout(check, 200);\n        }\n      })();\n    });\n  }\n\n  form.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n\n    // čekej na grecaptcha (pokud se nenačetlo, upozorni)\n    const greReady = await waitForGrecaptcha(5000);\n    if (!greReady) {\n      alert(\"reCAPTCHA se nenačetla. Prosím obnovte stránku a zkuste to znovu.\");\n      console.error(\"reCAPTCHA nebyla dostupná (timeout).\");\n      return;\n    }\n\n    // získej token (uživatel musí potvrdít checkbox)\n    const token = grecaptcha.getResponse();\n    if (!token) {\n      alert(\"Potvrďte prosím CAPTCHA (zaškrtněte, že nejste robot).\");\n      return;\n    }\n\n    // vytvoř FormData a přidej token do ní (NUTNÉ pro Formspree)\n    const data = new FormData(form);\n    data.append(\"g-recaptcha-response\", token);\n\n    // (volitelné) logni data pro debug v dev režimu\n    // for (let pair of data.entries()) console.log(pair[0], pair[1]);\n\n    try {\n      const response = await fetch(\"https://formspree.io/f/xanboklo\", {\n        method: \"POST\",\n        body: data,\n        headers: {\n          Accept: \"application/json\",\n        },\n      });\n\n      // zkus přečíst odpověď těla (pomůže při debug)\n      let respBody = null;\n      try {\n        respBody = await response.json();\n      } catch (err) {\n        // ne vždy posílají JSON\n      }\n\n      if (response.ok) {\n        alert(\"Děkujeme za zprávu. Ozveme se vám co nejdříve.\");\n        form.reset();\n        try { grecaptcha.reset(); } catch {}\n      } else {\n        console.error(\"Formspree returned non-OK\", response.status, respBody);\n        // ukaž smysluplnou zprávu uživateli\n        alert(\n          respBody && respBody.error\n            ? `Chyba: ${respBody.error}`\n            : `Došlo k chybě (${response.status}). Zkuste to prosím později.`\n        );\n      }\n    } catch (err) {\n      console.error(\"Fetch error:\", err);\n      alert(\"Chyba sítě při odesílání formuláře. Zkontrolujte připojení a zkuste to znovu.\");\n    }\n  });\n});\n"],"names":["typSelect","dumFields","bytFields","_a","aktualniRokEl","vysledek","delay","lokalita","typ","cenaZaM2","jednotky","plocha","celkovyNajem","sprava","dispozice","koef","najem","form","waitForGrecaptcha","timeout","resolve","start","check","e","token","data","response","respBody","err"],"mappings":"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"}